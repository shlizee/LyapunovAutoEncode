|United States }} 
 | language         = English; also available in Chinese and Japanese 
 | subject          = Unix operating system 
 | genre            = Computer Science 
 | publisher        = University of New South Wales 
 | pub_date         = 1976 
 | pages            = 
 | isbn             =  
 | oclc             = 36099640 
 | dewey            = 005.43 
 | congress         = QA 76.76 .O63 L56 
 }} 
 ''Lions' Commentary on UNIX 6th Edition, with Source Code'' by John Lions (1976) contains source code of the Version 6 Unix|6th Edition Unix kernel (computing)|kernel plus a commentary. It is commonly referred to as the Lions Book. Despite its age, it is still considered an excellent commentary on simple but high quality code. 
 
 For many years, the Lions book was the only Unix kernel documentation available outside Bell Labs. Although the license of 6th Edition allowed classroom use of the source code, the license of Version 7 Unix|7th Edition specifically excluded such use, so the book spread through illegal copy machine reproductions (a kind of samizdat). It was commonly held to be the most copied book in computer science. 
 
 The book was reprinted in 1996 by Peer-To-Peer Communications.    
 
 ==Synopsis== 
 File:Lions Commentary Unix.jpeg|thumb|Lions's original books with source code and commentary 
 
 ''Unix Operating System Source Code Level Six'' is the kernel source code, lightly edited by Lions to better separate the functionality & nbsp;â€” system initialization and process management, interrupts and system calls, basic I/O, file systems and pipes and character devices. All procedures and symbols are listed alphabetically with a cross reference. 
 
 The code as presented will run on a PDP-11/40 with RK-05 disk drive, LP-11 line printer interface, PCL-11 paper tape writer and KL-11 terminal interface, or a suitable PDP-11 emulator, such as SIMH. 
 
 ''A Commentary on the Unix Operating System'' starts with notes on Unix and other useful documentation (the Unix manual pages, Digital Equipment Corporation|DEC hardware manuals and so on), a section on the architecture of the PDP-11 and a chapter on how to read C (programming language)|C programs. The source commentary follows, divided into the same sections as the code. The book ends with suggested exercises for the student. 
 
 As Lions explains, this commentary supplements the comments in the source. It is possible to understand the code without the extra commentary, and the reader is advised to do so and only read the notes as needed. The commentary also remarks on how the code might be improved. 
 
 ==History== 
 File:Johnlions.jpg|thumb|John Lions with his students in 1980 
 File:Brian Kernighan in 2012 at Bell Labs 2.jpg|thumb|Brian Kernighan holding a copy of Lions's ''Commentary'' 
 
 The source code and commentary were originally produced in May 1976 as a set of lecture notes for Lions's computer science courses (6.602B and 6.657G) at the University of New South Wales Department of Computer Science. 
 
 ''UNIX News'' March 1977 announced the availability of the book to Unix licensees. Lions had trouble keeping up with its popularity, and by 1978 it was available only from Bell Labs. 
 
 When AT & T announced Version 7 Unix|Unix Version 7 at USENIX in June 1979, the academic/research license no longer automatically permitted classroom use. Thus, licensees were no longer able to use the Lions notes for classes on operating systems. 
 
 However, thousands of computer science students around the world spread photocopies. As they could not study it legally in class, they would sometimes meet after hours to discuss the book. Many pioneers of Unix and open-source software|open source had a treasured multiple-generation photocopy.    
 
 Other follow-on effects of the license change included Andrew S. Tanenbaum creating Minix. As Tanenbaum wrote in ''Operating Systems'' (1987): 
 
  
 
 Various Unix people, particularly Peter H. Salus, Dennis Ritchie and Berny Goodheart, lobbied Unix's various owners (AT & T, Novell, the Santa Cruz Operation) for many years to allow the book to be published officially. In 1996, the Santa Cruz Operation finally authorised the release of the twenty-year-old 6th Edition source code (along with the source code of other versions of  " Ancient UNIX " ), and the full code plus the 1977 version of the commentary was published by Peer-To-Peer Communications ().   The reissue includes commentary from Michael Tilson (SCO), Peter Salus, Dennis Ritchie, Ken Thompson (computer programmer)|Ken Thompson, Peter Collinson, Greg Rose, Mike O'Dell, Berny Goodheart and Peter Reintjes. 
 
 == " You are not expected to understand this " == 
 
 The infamous program comment  " You are not expected to understand this "  occurs on line 2238 of the source code (''Lions' Commentary'', p. & nbsp;22) at the end of a comment explaining the process exchange mechanism. It refers to line 325 of the file slp.c.     The source code reads:    
 
  
         /* 
          * If the new process paused because it was 
          * swapped out, set the stack level to the last call 
          * to savu(u_ssav).  This means that the return 
          * which is executed immediately after the call to aretu 
          * actually returns from the last routine which did 
          * the savu. 
          * 
          * You are not expected to understand this. 
          */ 
         if(rp- > p_flag & SSWAP) { 
                 rp- > p_flag = &  ~SSWAP; 
                 aretu(u.u_ssav); 
         } 
  
 
 A major reason why this piece of code was hard to understand was that it depended on a quirk of the way the C-compiler for the PDP-11 saved registers in procedure calls. This code failed when ported to other machines and had to be redesigned in Version 7 Unix.     Dennis Ritchie later explained the meaning of this remark:  
 
  
 
 ==See also== 
 xv6, a modern reimplementation of Version 6 Unix|Sixth Edition Unix in ANSI C for Multiprocessing|multiprocessor x86 and RISC-V systems. 
 
 ==References== 
  
 
 ==Further reading== 
 * Andrew S. Tanenbaum, ''Operating Systems: Design and Implementation'', (Prentice Hall, , June 1987) 
 * [ Code Critic] (Rachel Chalmers, ''Salon_(website)|Salon, 30 November 1999) 
 * [ The Daemon, The GNU and the Penguin - Ch. 6] (Peter H. Salus, 1979) 
 * Brian W. Kernighan and Dennis Ritchie, ''The C Programming Language (book)|The C Programming Language'',  
 
 ==External links== 
 * [ Complete commentary] in Portable Document Format|PDF, PostScript, and LaTeX formats 
 * Complete source code listing available in [ PDF] and [ HTML] formats. 
 
 Category:1976 non-fiction books 
 Category:Unix books 
 Category:Computer programming books 
 Category:Computer science books